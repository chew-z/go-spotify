<!--index.html-->

<!--Embed the header.html template at this location-->
{{ template "header.html" .}}
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js" integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ=" crossorigin="anonymous"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.27/moment-timezone-with-data-2012-2022.min.js" integrity="sha256-gfmyBrlUtChLivBA2rRK/bsljMoum6kxbl7oFeCVkmc=" crossorigin="anonymous"></script>
<h4 class="display-4">{{ .title }}</h4>
<div class="container">
<nav aria-label="Page navigation">
    {{ with .Navigation }}
  <ul class="pagination justify-content-end">
      <li class="page-item {{ if not .Previous }}disabled{{ end}}">
        <a class="page-link" href="/history?page={{ .Previous }}" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">Previous</span>
      </a>
    </li>
    {{ if .Previous }}
    <li class="page-item"><a class="page-link" href="/history?page={{ .Previous }}">{{ .Previous }}</a></li>
    {{ end }}
    <li class="page-item"><a class="page-link" href="/history?page={{ .Current }}">{{ .Current }}</a></li>
    <li class="page-item"><a class="page-link" href="/history?page={{ .Next }}">{{ .Next }}</a></li>
    <li class="page-item">
        <a class="page-link" href="/history?page={{ .Next }}" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Next</span>
      </a>
    </li>
  </ul>
    {{ end }}
</nav>
</div>
<div class="container">
    <script>
    $( document ).ready(function() {    
        let goT, gotime
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
    {{range .Tracks }}
            gotime = {{ .PlayedAt }}
            userTime = moment(gotime).tz(tz).format('ddd HH:mm');  
            $('#{{ .ID }}').text(userTime);
    {{end}}
    });
    </script>
    {{range .Tracks }}
    <div class="card">
        <div class="card-body">
<!-- <script> -->
<!--     $( document ).ready(function() { -->    
<!--     let gotime = {{ .PlayedAt }} -->
<!--     let goT = moment(gotime).tz(tz).format('ddd HH:mm'); -->  
<!--         $('#{{ .ID }}').text(goT); -->
<!--     }); -->
<!-- </script> -->
<p class="card-text"><mark id="{{.ID}}"></mark>&nbsp<a href="https://open.spotify.com/track/{{ .ID }}">{{.Name}}</a> <em>{{.Artists}}</em></p>
        </div>
    </div>
    {{end}}
</div>
<div class="container">
<nav aria-label="Page navigation example">
    {{ with .Navigation }}
  <ul class="pagination justify-content-end">
      <li class="page-item {{ if not .Previous }}disabled{{ end}}">
        <a class="page-link" href="/history?page={{ .Previous }}" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">Previous</span>
      </a>
    </li>
    {{ if .Previous }}
    <li class="page-item"><a class="page-link" href="/history?page={{ .Previous }}">{{ .Previous }}</a></li>
    {{ end }}
    <li class="page-item"><a class="page-link" href="/history?page={{ .Current }}">{{ .Current }}</a></li>
    <li class="page-item"><a class="page-link" href="/history?page={{ .Next }}">{{ .Next }}</a></li>
    <li class="page-item">
        <a class="page-link" href="/history?page={{ .Next }}" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Next</span>
      </a>
    </li>
  </ul>
    {{ end }}
</nav>
</div>

<!--Embed the footer.html template at this location-->
{{ template "footer.html" .}}
